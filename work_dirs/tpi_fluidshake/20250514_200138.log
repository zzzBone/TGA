2025-05-14 20:01:38,812 - sim - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
CUDA available: True
GPU 0: NVIDIA GeForce RTX 2080 Ti
CUDA_HOME: /usr/local/cuda-11.3
NVCC: Cuda compilation tools, release 11.3, V11.3.109
GCC: gcc (Ubuntu 6.5.0-2ubuntu1~16.04) 6.5.0 20181026
PyTorch: 1.12.1
PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.3
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.3.2  (built against CUDA 11.5)
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.3, CUDNN_VERSION=8.3.2, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.12.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=OFF, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

TorchVision: 0.13.1
OpenCV: 4.10.0
MMCV: 1.7.0
MMCV Compiler: GCC 9.3
MMCV CUDA Compiler: 11.3
Simulation: 0.7.0+2c5efa2
------------------------------------------------------------

2025-05-14 20:01:38,812 - sim - INFO - Distributed training: False
2025-05-14 20:01:38,920 - sim - INFO - Config:
model = dict(
    type='ParticleSimulator',
    backbone=dict(
        type='TPI',
        attr_dim=6,
        state_dim=6,
        position_dim=3,
        embed_dims=128,
        num_heads=8,
        num_encoder_layers=4,
        order=('selfattn', 'norm', 'ffn', 'norm')),
    head=dict(
        type='ParticleHead',
        in_channels=128,
        out_channels=3,
        seperate=False,
        rotation_dim=0,
        weighted=False,
        loss=dict(type='MSELoss', loss_weight=1.0)))
dataset_type = 'PhysicsFleXDataset'
pstep = 2
env_cfg = dict(
    env='FluidShake',
    num_abs_token=0,
    hierarchy=False,
    eval_ratio=10000000.0,
    dataf='./data/data_FluidShake/',
    n_rollout=2000,
    time_step=301,
    time_step_clip=0,
    attn_mask=8,
    dt=0.016666666666666666,
    nf_relation=300,
    nf_particle=200,
    nf_effect=200,
    train_valid_ratio=0.9,
    n_instance=1,
    n_stages=2,
    n_his=0,
    shape_state_dim=14,
    attr_dim=6,
    state_dim=6,
    position_dim=3,
    relation_dim=1,
    neighbor_radius=0.08,
    pstep=2,
    phases_dict=dict(root_num=[[]], instance=['fluid'], material=['fluid']))
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=8,
    train=dict(
        type='PhysicsFleXDataset',
        phase='train',
        env_cfg=dict(
            env='FluidShake',
            num_abs_token=0,
            hierarchy=False,
            eval_ratio=10000000.0,
            dataf='./data/data_FluidShake/',
            n_rollout=2000,
            time_step=301,
            time_step_clip=0,
            attn_mask=8,
            dt=0.016666666666666666,
            nf_relation=300,
            nf_particle=200,
            nf_effect=200,
            train_valid_ratio=0.9,
            n_instance=1,
            n_stages=2,
            n_his=0,
            shape_state_dim=14,
            attr_dim=6,
            state_dim=6,
            position_dim=3,
            relation_dim=1,
            neighbor_radius=0.08,
            pstep=2,
            phases_dict=dict(
                root_num=[[]], instance=['fluid'], material=['fluid'])),
        verbose=False),
    val=dict(
        type='PhysicsFleXDataset',
        phase='valid',
        env_cfg=dict(
            env='FluidShake',
            num_abs_token=0,
            hierarchy=False,
            eval_ratio=10000000.0,
            dataf='./data/data_FluidShake/',
            n_rollout=2000,
            time_step=301,
            time_step_clip=0,
            attn_mask=8,
            dt=0.016666666666666666,
            nf_relation=300,
            nf_particle=200,
            nf_effect=200,
            train_valid_ratio=0.9,
            n_instance=1,
            n_stages=2,
            n_his=0,
            shape_state_dim=14,
            attr_dim=6,
            state_dim=6,
            position_dim=3,
            relation_dim=1,
            neighbor_radius=0.08,
            pstep=2,
            phases_dict=dict(
                root_num=[[]], instance=['fluid'], material=['fluid'])),
        verbose=False),
    test=dict(
        type='PhysicsFleXDataset',
        phase='valid',
        env_cfg=dict(
            env='FluidShake',
            num_abs_token=0,
            hierarchy=False,
            eval_ratio=10000000.0,
            dataf='./data/data_FluidShake/',
            n_rollout=2000,
            time_step=301,
            time_step_clip=0,
            attn_mask=8,
            dt=0.016666666666666666,
            nf_relation=300,
            nf_particle=200,
            nf_effect=200,
            train_valid_ratio=0.9,
            n_instance=1,
            n_stages=2,
            n_his=0,
            shape_state_dim=14,
            attr_dim=6,
            state_dim=6,
            position_dim=3,
            relation_dim=1,
            neighbor_radius=0.08,
            pstep=2,
            phases_dict=dict(
                root_num=[[]], instance=['fluid'], material=['fluid'])),
        verbose=False))
optimizer = dict(
    type='Adam', lr=0.0008, betas=(0.9, 0.999), weight_decay=0, amsgrad=False)
optimizer_config = dict(grad_clip=None)
lr_config = dict(policy='Plateau', mode='min', factor=0.8, patience=3)
runner = dict(type='EpochBasedRunner', max_epochs=5)
checkpoint_config = dict(interval=1)
log_config = dict(interval=100, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl', port='29594')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
find_unused_parameters = True
work_dir = 'work_dirs/tpi_fluidshake/'
gpu_ids = range(0, 1)

2025-05-14 20:01:39,090 - sim - INFO - Model parameters: 2408963
2025-05-14 20:01:45,101 - sim - INFO - Start running, host: zbl@lab601-2, work_dir: /home/zbl/sim/TIE_ECCV2022/work_dirs/tpi_fluidshake
2025-05-14 20:01:45,102 - sim - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) PlateauLrUpdaterHook               
(NORMAL      ) CheckpointHook                     
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) PlateauLrUpdaterHook               
(NORMAL      ) MSEAccuracy                        
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) PlateauLrUpdaterHook               
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(NORMAL      ) MSEAccuracy                        
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2025-05-14 20:01:45,103 - sim - INFO - workflow: [('train', 1)], max: 5 epochs
2025-05-14 20:01:45,103 - sim - INFO - Checkpoints will be saved to /home/zbl/sim/TIE_ECCV2022/work_dirs/tpi_fluidshake by HardDiskBackend.
2025-05-14 20:02:11,201 - sim - INFO - Epoch [1][100/67500]	lr: 8.000e-04, eta: 1 day, 0:26:17, time: 0.261, data_time: 0.161, memory: 1832, loss: 0.3057, Batch std: 0.4526, Agg std: 0.5736
2025-05-14 20:02:25,015 - sim - INFO - Epoch [1][200/67500]	lr: 8.000e-04, eta: 18:41:06, time: 0.138, data_time: 0.097, memory: 1832, loss: 0.1677, Batch std: 0.3362, Agg std: 0.4183
2025-05-14 20:02:36,491 - sim - INFO - Epoch [1][300/67500]	lr: 8.000e-04, eta: 16:02:09, time: 0.115, data_time: 0.073, memory: 1832, loss: 0.1413, Batch std: 0.2984, Agg std: 0.3764
2025-05-14 20:02:50,434 - sim - INFO - Epoch [1][400/67500]	lr: 8.000e-04, eta: 15:17:18, time: 0.139, data_time: 0.099, memory: 1832, loss: 0.1291, Batch std: 0.2984, Agg std: 0.3548
2025-05-14 20:03:01,947 - sim - INFO - Epoch [1][500/67500]	lr: 8.000e-04, eta: 14:22:53, time: 0.115, data_time: 0.070, memory: 1832, loss: 0.1253, Batch std: 0.2742, Agg std: 0.3380
2025-05-14 20:03:11,461 - sim - INFO - Epoch [1][600/67500]	lr: 8.000e-04, eta: 13:27:53, time: 0.095, data_time: 0.050, memory: 1832, loss: 0.1060, Batch std: 0.2651, Agg std: 0.3263
2025-05-14 20:03:25,535 - sim - INFO - Epoch [1][700/67500]	lr: 8.000e-04, eta: 13:25:08, time: 0.141, data_time: 0.095, memory: 1832, loss: 0.1228, Batch std: 0.2707, Agg std: 0.3170
2025-05-14 20:03:34,717 - sim - INFO - Epoch [1][800/67500]	lr: 8.000e-04, eta: 12:48:40, time: 0.092, data_time: 0.044, memory: 1832, loss: 0.1202, Batch std: 0.2716, Agg std: 0.3112
2025-05-14 20:03:43,896 - sim - INFO - Epoch [1][900/67500]	lr: 8.000e-04, eta: 12:20:14, time: 0.092, data_time: 0.041, memory: 1832, loss: 0.1186, Batch std: 0.2686, Agg std: 0.3062
2025-05-14 20:03:53,053 - sim - INFO - Epoch [1][1000/67500]	lr: 8.000e-04, eta: 11:57:22, time: 0.092, data_time: 0.040, memory: 1832, loss: 0.0899, Batch std: 0.2413, Agg std: 0.3009
2025-05-14 20:04:06,443 - sim - INFO - Epoch [1][1100/67500]	lr: 8.000e-04, eta: 12:00:14, time: 0.134, data_time: 0.084, memory: 1832, loss: 0.0864, Batch std: 0.2329, Agg std: 0.2945
2025-05-14 20:04:17,771 - sim - INFO - Epoch [1][1200/67500]	lr: 8.000e-04, eta: 11:52:55, time: 0.113, data_time: 0.064, memory: 1832, loss: 0.1022, Batch std: 0.2440, Agg std: 0.2893
2025-05-14 20:04:26,770 - sim - INFO - Epoch [1][1300/67500]	lr: 8.000e-04, eta: 11:36:40, time: 0.090, data_time: 0.039, memory: 1832, loss: 0.1065, Batch std: 0.2506, Agg std: 0.2864
2025-05-14 20:04:35,733 - sim - INFO - Epoch [1][1400/67500]	lr: 8.000e-04, eta: 11:22:33, time: 0.090, data_time: 0.035, memory: 1832, loss: 0.0840, Batch std: 0.2273, Agg std: 0.2826
2025-05-14 20:04:46,452 - sim - INFO - Epoch [1][1500/67500]	lr: 8.000e-04, eta: 11:16:54, time: 0.107, data_time: 0.056, memory: 1832, loss: 0.0776, Batch std: 0.2220, Agg std: 0.2787
2025-05-14 20:04:59,837 - sim - INFO - Epoch [1][1600/67500]	lr: 8.000e-04, eta: 11:21:14, time: 0.134, data_time: 0.080, memory: 1832, loss: 0.0877, Batch std: 0.2286, Agg std: 0.2753
2025-05-14 20:05:08,926 - sim - INFO - Epoch [1][1700/67500]	lr: 8.000e-04, eta: 11:10:53, time: 0.091, data_time: 0.037, memory: 1832, loss: 0.0834, Batch std: 0.2259, Agg std: 0.2724
2025-05-14 20:05:18,102 - sim - INFO - Epoch [1][1800/67500]	lr: 8.000e-04, eta: 11:01:57, time: 0.092, data_time: 0.038, memory: 1832, loss: 0.0788, Batch std: 0.2209, Agg std: 0.2696
2025-05-14 20:05:30,153 - sim - INFO - Epoch [1][1900/67500]	lr: 8.000e-04, eta: 11:02:23, time: 0.120, data_time: 0.068, memory: 1832, loss: 0.0924, Batch std: 0.2397, Agg std: 0.2676
2025-05-14 20:05:40,941 - sim - INFO - Epoch [1][2000/67500]	lr: 8.000e-04, eta: 10:59:14, time: 0.108, data_time: 0.053, memory: 1832, loss: 0.0753, Batch std: 0.2213, Agg std: 0.2657
2025-05-14 20:05:50,194 - sim - INFO - Epoch [1][2100/67500]	lr: 8.000e-04, eta: 10:52:16, time: 0.092, data_time: 0.034, memory: 1832, loss: 0.0884, Batch std: 0.2287, Agg std: 0.2635
2025-05-14 20:05:58,931 - sim - INFO - Epoch [1][2200/67500]	lr: 8.000e-04, eta: 10:44:38, time: 0.087, data_time: 0.030, memory: 1832, loss: 0.0779, Batch std: 0.2205, Agg std: 0.2620
2025-05-14 20:06:10,263 - sim - INFO - Epoch [1][2300/67500]	lr: 8.000e-04, eta: 10:43:57, time: 0.113, data_time: 0.057, memory: 1832, loss: 0.0650, Batch std: 0.2023, Agg std: 0.2596
2025-05-14 20:06:22,534 - sim - INFO - Epoch [1][2400/67500]	lr: 8.000e-04, eta: 10:45:30, time: 0.123, data_time: 0.072, memory: 1832, loss: 0.0808, Batch std: 0.2241, Agg std: 0.2577
2025-05-14 20:06:31,722 - sim - INFO - Epoch [1][2500/67500]	lr: 8.000e-04, eta: 10:40:01, time: 0.092, data_time: 0.037, memory: 1832, loss: 0.0666, Batch std: 0.2084, Agg std: 0.2560
2025-05-14 20:06:41,158 - sim - INFO - Epoch [1][2600/67500]	lr: 8.000e-04, eta: 10:35:28, time: 0.094, data_time: 0.038, memory: 1832, loss: 0.0751, Batch std: 0.2166, Agg std: 0.2542
2025-05-14 20:06:54,984 - sim - INFO - Epoch [1][2700/67500]	lr: 8.000e-04, eta: 10:40:19, time: 0.138, data_time: 0.084, memory: 1832, loss: 0.0721, Batch std: 0.2113, Agg std: 0.2528
2025-05-14 20:07:04,123 - sim - INFO - Epoch [1][2800/67500]	lr: 8.000e-04, eta: 10:35:28, time: 0.091, data_time: 0.032, memory: 1832, loss: 0.0604, Batch std: 0.2014, Agg std: 0.2510
2025-05-14 20:07:12,858 - sim - INFO - Epoch [1][2900/67500]	lr: 8.000e-04, eta: 10:30:10, time: 0.087, data_time: 0.028, memory: 1832, loss: 0.0680, Batch std: 0.2073, Agg std: 0.2494
2025-05-14 20:07:24,503 - sim - INFO - Epoch [1][3000/67500]	lr: 8.000e-04, eta: 10:30:38, time: 0.116, data_time: 0.070, memory: 1832, loss: 0.0608, Batch std: 0.1978, Agg std: 0.2478
2025-05-14 20:07:35,792 - sim - INFO - Epoch [1][3100/67500]	lr: 8.000e-04, eta: 10:30:24, time: 0.113, data_time: 0.058, memory: 1832, loss: 0.0718, Batch std: 0.2125, Agg std: 0.2463
2025-05-14 20:07:44,678 - sim - INFO - Epoch [1][3200/67500]	lr: 8.000e-04, eta: 10:25:59, time: 0.089, data_time: 0.034, memory: 1832, loss: 0.0543, Batch std: 0.1945, Agg std: 0.2450
